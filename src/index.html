<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>DownGit 2.0</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.10/semantic.min.css">
    <link rel="stylesheet" href="../node_modules/sweetalert2/dist/sweetalert2.min.css">
  </head>
  <body>
    <div id="root"></div>
  </body>

  <!-- Insert this line above script imports  -->
  <script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.10/semantic.min.js" type="text/javascript"></script>
    <script type="text/javascript">
    setTimeout(function () {
      $('.ui.search')
        .search({
          apiSettings: {
            url: 'https://api.github.com/search/repositories?q={query}',
            onResponse: function (githubResponse) {
              $('#repos').empty();
              githubResponse.items.forEach(function(e, i, a) {
                const box = `
                <div class="ui raised very padded text container segment">
                  <h2 class="ui header"><a href="#">${e.full_name}</a></h2>
                  <a href="${e.html_url}/archive/${e.default_branch}.zip"><button class="download ui button">Download</button></a>
                </div>`;
                $('#repos').append(box);
              });
              return {};
            }
          },
          fields: {
            results : 'items',
            title   : 'name',
            url     : 'html_url'
          },
          minCharacters : 3,
          showNoResults: false
        });
      }, 250);
    </script>
    <script type="text/javascript">
    const mkdir = require('mkdirp');
    const path = require('path');
    const os = require('os');
    const swal = require('sweetalert2');
    const fs = require('fs');

    if (!fs.existsSync(`${os.homedir()}/.techfolios`)) {
      swal({
        title: '~/.techfolios',
        text: "Do we have your permission to create the above directory? (You need to say yes for techfolios to work.)",
        type: 'info',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, create it!'
      }).then(function () {
        mkdir(`${os.homedir()}/.techfolios`, function (err) {
          if (err) console.error(err);
          else {
            swal(
              'Success!',
              'Your directory has been created!',
              'success'
            )
          }
        });
      }, function (dismiss) {
        if (dismiss === 'cancel') {
          swal(
            'Cancelled',
            'The directory has not been created. (???)',
            'error'
          )
        }
      });
    }
    </script>
    <script src="index.jsx" type="text/javascript"></script>
  <!-- Insert this line after script imports -->
  <script>if (window.module) module = window.module;</script>
  <script>
    require('./renderer.js')
  </script>

</html>
